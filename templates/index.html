<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <title>ToDo List Inteligente</title>
    <!-- Link para o arquivo de CSS que deixa a pÃ¡gina mais bonita -->
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>
    <div class="container">
        <h1>ðŸ“‹ Minhas Listas</h1> <!-- TÃ­tulo principal da aplicaÃ§Ã£o -->

        <!-- =======================
             FORMULÃRIO PARA CRIAR NOVA LISTA
             - Aqui o usuÃ¡rio pode digitar o tÃ­tulo de uma lista
             - Quando envia, a pÃ¡gina recarrega e a lista Ã© salva no banco
        ======================== -->
        <form method="POST" class="nova-lista-form">
            <input type="text" name="title" placeholder="Criar tÃ­tulo da lista" required>
            <button type="submit" class="btn-criar">âž• Criar Lista</button>
        </form>

        <!-- =======================
             LOOP PELO FLASK (JINJA)
             - Aqui o Flask envia todas as listas do banco de dados
             - Para cada lista encontrada, um â€œblocoâ€ Ã© exibido
        ======================== -->
        {% for lista in lists %}
            <div class="lista">
                <!-- CabeÃ§alho da lista: tÃ­tulo, data de criaÃ§Ã£o e botÃ£o para apagar -->
                <div class="lista-header">
                    <h2>{{ lista.title }}</h2>
                    <span class="data">Criada em: {{ lista.created_at.strftime('%d/%m/%Y %H:%M') }}</span>
                    <a href="{{ url_for('delete_list', list_id=lista.id) }}" class="btn-apagar">ðŸ—‘ Apagar Lista</a>
                </div>

                <!-- =======================
                     FORMULÃRIO PARA ADICIONAR ITENS NA LISTA
                     - Cada lista tem o seu prÃ³prio formulÃ¡rio
                     - Assim o usuÃ¡rio pode adicionar itens especÃ­ficos em cada lista
                ======================== -->
                <form action="{{ url_for('add_item', list_id=lista.id) }}" method="POST" class="novo-item-form">
                    <input type="text" name="item_name" placeholder="Nome do item" required>
                    <input type="text" name="item_price" placeholder="Valor (opcional)">
                    <input type="text" name="item_category" placeholder="Categoria">
                    <button type="submit" class="btn-adicionar">âž• Adicionar</button>
                </form>

                <!-- =======================
                     LISTA DE ITENS
                     - Aqui exibimos todos os itens da lista
                     - Ordenados em ordem alfabÃ©tica pelo nome do item
                ======================== -->
                <ul class="itens-lista">
                    {% for item in lista.items|sort(attribute='name') %}
                        <li class="item">
                            <!-- Nome do item -->
                            <span class="item-nome">{{ item.name }}</span> -

                            <!-- PreÃ§o do item (ou mensagem caso nÃ£o tenha preÃ§o) -->
                            <span class="item-preco">
                                {{ item.price if item.price else "ðŸ’¸ sem valor" }}
                            </span> -

                            <!-- Categoria do item (ou mensagem caso nÃ£o tenha categoria) -->
                            <span class="item-categoria">
                                {{ item.category if item.category else "ðŸ“‚ sem categoria" }}
                            </span>

                            <!-- Se o item estiver concluÃ­do, mostra o check; senÃ£o, botÃ£o para concluir -->
                            {% if item.completed %}
                                âœ… <span class="concluido">ConcluÃ­do</span>
                            {% else %}
                                <a href="{{ url_for('toggle_complete', item_id=item.id) }}" class="btn-concluir">âœ” Concluir</a>
                            {% endif %}

                            <!-- BotÃ£o para apagar o item -->
                            <a href="{{ url_for('delete_item', item_id=item.id) }}" class="btn-apagar-item">ðŸ—‘ Apagar</a>
                        </li>
                    {% endfor %}
                </ul>

                <!-- =======================
                     TOTAL DE TODOS OS ITENS DA LISTA
                     - SomatÃ³rio calculado no back-end (Flask)
                     - FormataÃ§Ã£o para mostrar sempre 2 casas decimais (R$ 0.00)
                ======================== -->
                <div class="total">
                    <strong>Total: </strong> R$ {{ "%.2f"|format(lista.total) }}
                </div>
            </div>
        {% endfor %}
    </div>
<script src="{{ url_for('static', filename='script.js') }}"></script>


</body>
</html>
